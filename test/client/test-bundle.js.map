{"version":3,"sources":["webpack:///webpack/bootstrap c3d69f9423bab1447f53","webpack:///./test/client/index.js","webpack:///./test/client/test-encryption.js","webpack:///./src/client/encryption.js","webpack:///./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js","webpack:///./node_modules/base-64/base64.js","webpack:///(webpack)/buildin/module.js","webpack:///(webpack)/buildin/global.js"],"names":["require","encryption","describe","it","expect","isCryptoSupported","to","be","ok","generateKey","then","key","type","equal","data","encrypt","cipherText","a","not","exportKey","keyString","importKey","keyObj","_key","_cipherText","password","console","log","keyFromPassword","decrypt","text","key1","key2","key2String","key2ForDecypting","catch","err","message","contain","Base64Array","Base64","window","crypto","undefined","subtle","name","length","keyBuffer","encode","string","buffer","decode","getIv","getRandomValues","Uint8Array","plainText","iv","cipherTextBuffer","ivString","payload","ivBase64","substring","indexOf","plainTextBuffer","Promise","reject","Error"],"mappings":"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QG,OAAR,CAAgB,GAAhB,IAAuB,CAAzC,EAA4CH,QAAQb,MAApD,CAAnB;AACA,QAAMU,KAAKjB,YAAYY,MAAZ,CAAmBS,QAAnB,CAAX;AACA,QAAMH,mBAAmBlB,YAAYY,MAAZ,CAAmBnC,UAAnB,CAAzB;;AAEA,WAAOyB,OAAOC,MAAP,CAAcE,MAAd,CAAqBf,OAArB,CACH;AACIgB,cAAM,SADV;AAEIW,YAAIA;AAFR,KADG,EAKH7C,GALG,EAMH8C,gBANG,EAOL/C,IAPK,CAOA,UAACqD,eAAD,EAAqB;AACxB,eAAOvB,OAAOW,MAAP,CAAcZ,YAAYS,MAAZ,CAAmBe,eAAnB,CAAd,CAAP;AACH,KATM,EASJ5B,KATI,CASE,YAAM;AACX,eAAO6B,QAAQC,MAAR,CAAe,IAAIC,KAAJ,CAAU,mBAAV,CAAf,CAAP;AACH,KAXM,CAAP;AAYH,C;;;;;;AC9ED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;;AAEA;AACA;AACA;;AAEA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,eAAe,SAAS;AACxB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;;;;;sDClED;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAEA;AACA;AACA;AACA;AACA,GAAG;AAAA;AACH,EAAE;AACF,mBAAmB;AACnB;AACA,GAAG,OAAO;AACV;AACA;AACA;AACA;AACA,EAAE,OAAO;AACT;AACA;;AAEA,CAAC;;;;;;;;ACpKD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;;;;;ACrBA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C","file":"test-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c3d69f9423bab1447f53","require('./test-encryption'); \n\n\n// WEBPACK FOOTER //\n// ./test/client/index.js","const encryption = require('../../src/client/encryption');\n\ndescribe('Encryption', () => {\n    describe('#isCryptoSupported()', () => {\n        it('should return true if webcryptography is supported', () => {\n            expect(encryption.isCryptoSupported()).to.be.ok();\n        });\n    });\n\n    describe('#generateKey()', () => {\n        it('should return a generate AES key', () => {\n            return encryption.generateKey().then((key) => {\n                expect(key.type).to.equal('secret');\n            })\n        });\n    });\n\n    describe('#encrypt()', () => {\n        it('should return base64 encoded data', () => {\n            const data = 'abc';\n            return encryption.generateKey().then((key) => {\n                return encryption.encrypt(key, data).then((cipherText) => {\n                    expect(cipherText).to.be.a('string');\n                    expect(cipherText).to.not.equal(data);\n                });\n            });\n        });\n    });\n\n    describe('#keyToString()', () => {\n        it('should return base64 encoded key', () => {\n            return encryption.generateKey().then((key) => {\n                return encryption.exportKey(key).then((keyString) => {\n                    expect(keyString).to.be.a('string');\n                });\n            });\n        });\n    });\n\n    describe('#stringToKey()', () => {\n        it('should return a key', () => {\n            return encryption.generateKey().then((key) => {\n                return encryption.exportKey(key).then((keyString) => {\n                    return encryption.importKey(keyString).then((keyObj) => {\n                        expect(keyObj.type).to.equal('secret');\n                    });\n                });\n            });\n        });\n    });\n\n    describe('#decrypt()', () => {\n        it('should encrypt and decrypt a string', () => {\n            let key, cipherText;\n            return encryption.generateKey().then((_key) => {\n                key = _key;\n                return encryption.encrypt(key, 'abc');\n            }).then((_cipherText) => {\n                cipherText = _cipherText;\n                return encryption.exportKey(key);\n            }).then((password) => {\n                console.log(password);\n                return encryption.importKey(password);\n            }).then((keyFromPassword) => {\n                console.log(keyFromPassword);\n                return encryption.decrypt(keyFromPassword, cipherText);\n            }).then((text) => {\n                expect(text).to.equal('abc');\n            });\n        });\n\n        it('should throw an error if attempting to decrypt with bad key', () => {\n            let key1, key2, cipherText;\n            return encryption.generateKey().then((_key) => {\n                key1 = _key;\n                return encryption.generateKey();\n            }).then((_key) => {\n                key2 = _key;\n                return encryption.encrypt(key1, 'abc');\n            }).then((_cipherText) => {\n                cipherText = _cipherText;\n                return encryption.exportKey(key2);\n            }).then((key2String) => {\n                return encryption.importKey(key2String);\n            }).then((key2ForDecypting) => {\n                return encryption.decrypt(key2ForDecypting, cipherText);\n            }).catch((err) => {\n                expect(err.message).to.contain('decryption failed');\n            });\n        });\n\n        it('should throw an error if attempting to use non-imported key for decryption', () => {\n            let key;\n            return encryption.generateKey().then((_key) => {\n                key = _key;\n                return encryption.encrypt(key, '123');\n            }).then((cipherText) => {\n                return encryption.decrypt(key, cipherText)\n            }).catch((err) => {\n                expect(err.message).to.contain('decryption failed');\n            });\n        });\n\n        it('should support utf-8 strings', () => {\n            let key, cipherText;\n            return encryption.generateKey().then((_key) => {\n                key = _key;\n                return encryption.encrypt(key, 'Iñtërnâtiônàlizætiøn');\n            }).then((_cipherText) => {\n                cipherText = _cipherText;\n                return encryption.exportKey(key);\n            }).then((password) => {\n                console.log(password);\n                return encryption.importKey(password);\n            }).then((keyFromPassword) => {\n                console.log(keyFromPassword);\n                return encryption.decrypt(keyFromPassword, cipherText);\n            }).then((text) => {\n                expect(text).to.equal('Iñtërnâtiônàlizætiøn');\n            });\n        });\n    });\n});\n\n\n// WEBPACK FOOTER //\n// ./test/client/test-encryption.js","const Base64Array = require('base64-arraybuffer');\nconst Base64 = require('base-64');\n\nexport function isCryptoSupported() {\n    return window.crypto !== undefined;\n}\n\nexport function generateKey() {\n    return window.crypto.subtle.generateKey(\n        {\n            name: 'AES-GCM',\n            length: 128\n        },\n        true,\n        [\"encrypt\"]\n    );\n}\n\nexport function exportKey(key) {\n    return window.crypto.subtle.exportKey(\n        'raw',\n        key\n    ).then((keyBuffer) => {\n        return Base64Array.encode(keyBuffer);\n    });\n}\n\nexport function importKey(string) {\n    const buffer = Base64Array.decode(string);\n    return window.crypto.subtle.importKey(\n        'raw',\n        buffer,\n        {\n            name: 'AES-GCM'\n        },\n        false,\n        [\"decrypt\"]\n    );\n}\n\nfunction getIv() {\n    return window.crypto.getRandomValues(new Uint8Array(12));\n}\n\nexport function encrypt(key, plainText) {\n    const iv = getIv();\n    return window.crypto.subtle.encrypt(\n        {\n            name: 'AES-GCM',\n            iv: iv\n        },\n        key,\n        Base64Array.decode(Base64.encode(plainText))\n    ).then((cipherTextBuffer) => {\n        const cipherText = Base64Array.encode(cipherTextBuffer);\n        const ivString = Base64Array.encode(iv);\n        return `${ivString}.${cipherText}`;\n    });\n}\n\nexport function decrypt(key, payload) {\n    const ivBase64 = payload.substring(0, payload.indexOf('.'));\n    const cipherText = payload.substring(payload.indexOf('.') + 1, payload.length);\n    const iv = Base64Array.decode(ivBase64);\n    const cipherTextBuffer = Base64Array.decode(cipherText);\n\n    return window.crypto.subtle.decrypt(\n        {\n            name: 'AES-GCM',\n            iv: iv\n        },\n        key,\n        cipherTextBuffer\n    ).then((plainTextBuffer) => {\n        return Base64.decode(Base64Array.encode(plainTextBuffer))\n    }).catch(() => {\n        return Promise.reject(new Error('decryption failed'));\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/encryption.js","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(){\n  \"use strict\";\n\n  var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n  // Use a lookup table to find the index.\n  var lookup = new Uint8Array(256);\n  for (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n  }\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = lookup[base64.charCodeAt(i)];\n      encoded2 = lookup[base64.charCodeAt(i+1)];\n      encoded3 = lookup[base64.charCodeAt(i+2)];\n      encoded4 = lookup[base64.charCodeAt(i+3)];\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js\n// module id = 3\n// module chunks = 0","/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */\n;(function(root) {\n\n\t// Detect free variables `exports`.\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`.\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code, and use\n\t// it as `root`.\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar InvalidCharacterError = function(message) {\n\t\tthis.message = message;\n\t};\n\tInvalidCharacterError.prototype = new Error;\n\tInvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\n\tvar error = function(message) {\n\t\t// Note: the error messages used throughout this file match those used by\n\t\t// the native `atob`/`btoa` implementation in Chromium.\n\t\tthrow new InvalidCharacterError(message);\n\t};\n\n\tvar TABLE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\t// http://whatwg.org/html/common-microsyntaxes.html#space-character\n\tvar REGEX_SPACE_CHARACTERS = /[\\t\\n\\f\\r ]/g;\n\n\t// `decode` is designed to be fully compatible with `atob` as described in the\n\t// HTML Standard. http://whatwg.org/html/webappapis.html#dom-windowbase64-atob\n\t// The optimized base64-decoding algorithm used is based on @atk’s excellent\n\t// implementation. https://gist.github.com/atk/1020396\n\tvar decode = function(input) {\n\t\tinput = String(input)\n\t\t\t.replace(REGEX_SPACE_CHARACTERS, '');\n\t\tvar length = input.length;\n\t\tif (length % 4 == 0) {\n\t\t\tinput = input.replace(/==?$/, '');\n\t\t\tlength = input.length;\n\t\t}\n\t\tif (\n\t\t\tlength % 4 == 1 ||\n\t\t\t// http://whatwg.org/C#alphanumeric-ascii-characters\n\t\t\t/[^+a-zA-Z0-9/]/.test(input)\n\t\t) {\n\t\t\terror(\n\t\t\t\t'Invalid character: the string to be decoded is not correctly encoded.'\n\t\t\t);\n\t\t}\n\t\tvar bitCounter = 0;\n\t\tvar bitStorage;\n\t\tvar buffer;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\twhile (++position < length) {\n\t\t\tbuffer = TABLE.indexOf(input.charAt(position));\n\t\t\tbitStorage = bitCounter % 4 ? bitStorage * 64 + buffer : buffer;\n\t\t\t// Unless this is the first of a group of 4 characters…\n\t\t\tif (bitCounter++ % 4) {\n\t\t\t\t// …convert the first 8 bits to a single ASCII character.\n\t\t\t\toutput += String.fromCharCode(\n\t\t\t\t\t0xFF & bitStorage >> (-2 * bitCounter & 6)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t};\n\n\t// `encode` is designed to be fully compatible with `btoa` as described in the\n\t// HTML Standard: http://whatwg.org/html/webappapis.html#dom-windowbase64-btoa\n\tvar encode = function(input) {\n\t\tinput = String(input);\n\t\tif (/[^\\0-\\xFF]/.test(input)) {\n\t\t\t// Note: no need to special-case astral symbols here, as surrogates are\n\t\t\t// matched, and the input is supposed to only contain ASCII anyway.\n\t\t\terror(\n\t\t\t\t'The string to be encoded contains characters outside of the ' +\n\t\t\t\t'Latin1 range.'\n\t\t\t);\n\t\t}\n\t\tvar padding = input.length % 3;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\tvar a;\n\t\tvar b;\n\t\tvar c;\n\t\tvar d;\n\t\tvar buffer;\n\t\t// Make sure any padding is handled outside of the loop.\n\t\tvar length = input.length - padding;\n\n\t\twhile (++position < length) {\n\t\t\t// Read three bytes, i.e. 24 bits.\n\t\t\ta = input.charCodeAt(position) << 16;\n\t\t\tb = input.charCodeAt(++position) << 8;\n\t\t\tc = input.charCodeAt(++position);\n\t\t\tbuffer = a + b + c;\n\t\t\t// Turn the 24 bits into four chunks of 6 bits each, and append the\n\t\t\t// matching character for each of them to the output.\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 18 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 12 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 6 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer & 0x3F)\n\t\t\t);\n\t\t}\n\n\t\tif (padding == 2) {\n\t\t\ta = input.charCodeAt(position) << 8;\n\t\t\tb = input.charCodeAt(++position);\n\t\t\tbuffer = a + b;\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 10) +\n\t\t\t\tTABLE.charAt((buffer >> 4) & 0x3F) +\n\t\t\t\tTABLE.charAt((buffer << 2) & 0x3F) +\n\t\t\t\t'='\n\t\t\t);\n\t\t} else if (padding == 1) {\n\t\t\tbuffer = input.charCodeAt(position);\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 2) +\n\t\t\t\tTABLE.charAt((buffer << 4) & 0x3F) +\n\t\t\t\t'=='\n\t\t\t);\n\t\t}\n\n\t\treturn output;\n\t};\n\n\tvar base64 = {\n\t\t'encode': encode,\n\t\t'decode': decode,\n\t\t'version': '0.1.0'\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn base64;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = base64;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (var key in base64) {\n\t\t\t\tbase64.hasOwnProperty(key) && (freeExports[key] = base64[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.base64 = base64;\n\t}\n\n}(this));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/base-64/base64.js\n// module id = 4\n// module chunks = 0","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/module.js\n// module id = 5\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}